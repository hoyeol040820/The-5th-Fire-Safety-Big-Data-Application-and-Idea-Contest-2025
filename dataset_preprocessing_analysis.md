# 📊 서울시 화재안전 빅데이터 전처리 분석 보고서

> **작성일**: 2025년 1월  
> **분석 대상**: 8개 원본 데이터셋의 전처리 과정  
> **목적**: 서울시 구/동별 화재 위험도 분석을 위한 데이터 전처리

---

## 🏗️ 전처리 파이프라인 구조

모든 데이터셋은 **4단계 표준화된 전처리 파이프라인**을 통해 처리됩니다:

```mermaid
graph LR
    A[📁 0_original] --> B[🔗 1_merge_column_names]
    B --> C[🔍 2_filtering]
    C --> D[🔄 3_pivot]
    D --> E[🎯 4_select_feature]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#fff3e0
    style D fill:#e8f5e8
    style E fill:#fce4ec
```

| 단계 | 디렉토리 | 주요 작업 | 목적 |
|------|----------|-----------|------|
| **1단계** | `1_merge_column_names` | 복잡한 헤더 병합, 컬럼명 정리 | 데이터 구조 표준화 |
| **2단계** | `2_filtering` | 불필요한 데이터 제거, 조건 필터링 | 분석 대상 데이터 선별 |
| **3단계** | `3_pivot` | 행-열 구조 변환 | 분석 친화적 형태로 변환 |
| **4단계** | `4_select_feature` | 핵심 특성만 선택 | 최종 분석용 데이터 생성 |

---

## 📋 데이터셋별 상세 전처리 과정

### 1️⃣ 서울시 행정구역(동별) 면적 데이터

**📂 원본파일**: `서울시_행정구역(동별)_면적.csv` (455줄, 21KB)

#### 🔍 원본 데이터 특징
- **복잡한 3줄 헤더 구조**
```
"동별(1)",동별(2),동별(3),2023,2023,2023,2023
"동별(1)",동별(2),동별(3),면적,면적,동,동
"동별(1)",동별(2),동별(3),면적 (k㎡),구성비 (%),행정,법정
```

#### ⚙️ 전처리 과정

| 단계 | 처리 내용 | 결과 |
|------|-----------|------|
| **1️⃣ 컬럼 병합** | • 3줄 헤더를 하나로 통합<br>• 컬럼명 한글화 (`시도명`, `구명`, `동명`, `면적_km2`, `구성비_percent`, `행정동_수`, `법정동_수`)<br>• 데이터 타입 정리 (숫자 변환, 결측값 처리) | 451개 행정동, 7개 컬럼 |
| **2️⃣ 필터링** | • `행정동_수`, `법정동_수` 컬럼 제거 (분석에 불필요) | 451개 행정동, 5개 컬럼 |
| **3️⃣ 피벗** | 해당없음 | - |
| **4️⃣ 특성선택** | 해당없음 | - |

#### 📊 최종 결과
- **데이터 크기**: 451개 행정동
- **컬럼**: `시도명`, `구명`, `동명`, `면적_km2`, `구성비_percent`
- **활용 목적**: 구/동별 면적 기반 위험도 밀도 계산

---

### 2️⃣ 노후기간별 주택현황 데이터

**📂 원본파일**: `노후기간별+주택현황_20250710173050.csv` (30줄, 2.6KB)

#### 🔍 원본 데이터 특징
- **3줄 계층형 헤더**: 연도 → 노후기간 → 주택유형
- **주택 노후도별 세분화**: 20년~30년미만, 30년이상 각각 6개 주택유형

#### ⚙️ 전처리 과정

| 단계 | 처리 내용 | 결과 |
|------|-----------|------|
| **1️⃣ 컬럼 병합** | • 3줄 헤더 → `{연도}_{기간}_{주택유형}` 형식<br>• 예: `2023_20년~30년미만_계`, `2023_30년이상_아파트` | 26개 지역, 14개 컬럼 |
| **2️⃣ 필터링** | 해당없음 (원본 그대로 유지) | - |
| **3️⃣ 피벗** | 해당없음 | - |
| **4️⃣ 특성선택** | • 핵심 지표만 선택<br>• `시도명`, `구명`, `20년~30년미만_주택수`, `30년이상_주택수` | 26개 지역, 4개 컬럼 |

#### 📊 최종 결과
- **데이터 크기**: 26개 자치구 (서울시 전체 + 25개 구)
- **핵심 지표**: 노후 주택 현황 (20년 이상)
- **활용 목적**: 주택 노후도 기반 화재 위험도 평가

#### 🏘️ 주요 통계
- **30년이상 주택 비율 상위 5개구**: 노원구(59.2%), 강남구(58.3%), 강북구(55.4%), 송파구(55.2%), 양천구(53.2%)

---

### 3️⃣ 화재발생 현황 데이터

**📂 원본파일**: `화재발생+현황_20250710140523.csv` (30줄, 3.4KB)

#### 🔍 원본 데이터 특징
- **3줄 복합 헤더**: 연도 → 카테고리 → 세부항목
- **25개 화재 관련 지표**: 발생건수, 피해액, 인명피해, 재산피해 등

#### ⚙️ 전처리 과정

| 단계 | 처리 내용 | 결과 |
|------|-----------|------|
| **1️⃣ 컬럼 병합** | • 3줄 헤더 → `2024_{카테고리}_{세부항목}` 형식<br>• 25개 화재 관련 지표 컬럼 생성 | 26개 행, 27개 컬럼 |
| **2️⃣ 필터링** | • `동별(1)` 컬럼 제거 (모두 "합계")<br>• "소계" 행 제거 (전체 합계) | 25개 구, 26개 컬럼 |
| **3️⃣ 피벗** | 해당없음 | - |
| **4️⃣ 특성선택** | 해당없음 (모든 지표 활용) | - |

#### 📊 최종 결과
- **데이터 크기**: 25개 자치구
- **지표**: 화재발생건수, 인명피해, 재산피해, 소실면적 등
- **활용 목적**: 실제 화재 발생 이력 기반 위험도 평가

#### 🔥 주요 통계
- **화재 발생 상위 5개구**: 광진구(223건), 종로구(197건), 성동구(174건), 중구(173건), 동대문구(162건)

---

### 4️⃣ 서울시 등록인구 데이터 ⭐

**📂 원본파일**: `서울시_등록인구_2025_1분기.csv` (9,945줄, 528KB)

#### 🔍 원본 데이터 특징
- **대용량 데이터**: 9,945줄, 구/동별 × 연령대별 교차 구조
- **복잡한 계층 구조**: 구와 동이 하나의 컬럼에 혼재

#### ⚙️ 전처리 과정

| 단계 | 처리 내용 | 결과 |
|------|-----------|------|
| **1️⃣ 컬럼 병합** | • 구/동 분리: `구`, `동` 별도 컬럼 생성<br>• 계층적 데이터 구조 정리 | 9,944개 행 |
| **2️⃣ 필터링** | • 세부 동 데이터만 유지 (합계, 구계 제외)<br>• 시점 컬럼 제거<br>• 동별 세부 데이터만 추출 | 9,372개 행 |
| **3️⃣ 피벗** 🔄 | • **연령대별 행 → 연령대별 컬럼으로 변환**<br>• 각 구/동별로 21개 연령대가 컬럼으로 변환<br>• 중복 제거 ('합계' 연령대 제외) | 426개 구/동, 23개 컬럼 |
| **4️⃣ 특성선택** | • 취약 연령층 그룹화<br>• `0~14세` = 유아+아동 합계<br>• `65세 이상` = 고령층 합계 | 426개 구/동, 4개 컬럼 |

#### 📊 최종 결과
- **데이터 크기**: 426개 행정동
- **컬럼**: `구`, `동`, `0~14세`, `65세 이상`
- **활용 목적**: 화재 취약 연령층 분포 분석

#### 👥 주요 통계
- **총 인구**: 9,602,826명 (한국인 97.2%, 등록외국인 2.8%)
- **취약 연령층**: 0~14세 (8.7%), 65세 이상 (18.9%)

---

### 5️⃣ 서울시 구조출동 데이터 ⭐

**📂 원본파일**: `서울시_구조출동_2023_한강.csv` (46MB, 대용량)

#### 🔍 원본 데이터 특징
- **초대용량**: 128,564건의 구조출동 기록
- **60개 상세 컬럼**: 사고유형, 발생위치, 처리결과 등
- **다양한 사고 유형**: 화재, 교통, 수난, 산악 등

#### ⚙️ 전처리 과정

| 단계 | 처리 내용 | 결과 |
|------|-----------|------|
| **1️⃣ 컬럼 병합** | 해당없음 (이미 정리된 상태) | - |
| **2️⃣ 필터링** 🎯 | • **화재 데이터만 추출**: `ACDNT_CS_NM == '화재'`<br>• 128,564건 → 56,290건 (43.8%) | 56,290건 |
| **3️⃣ 피벗** | 해당없음 | - |
| **4️⃣ 특성선택** | • 추가 필터링: 오인신고 제외, 도로사고 제외<br>• 5개 핵심 컬럼 선택<br>• `발생지역_시도명`, `발생지역_시군구명`, `피해지역_경도`, `피해지역_위도`, `처리결과_구분명` | 최종 필터링된 데이터 |

#### 📊 최종 결과
- **데이터 크기**: 화재 관련 구조출동 기록
- **지리 정보**: 경도/위도 좌표 포함
- **활용 목적**: 실제 화재 발생 위치 기반 히트맵 생성

#### 🚒 주요 통계
- **화재 데이터 비율**: 전체 구조출동의 43.8%
- **처리 결과**: 타기관처리(18.7%), 기타안전조치(15.9%), 자체처리(13.3%)

---

### 6️⃣ 재난안전취약자 정보 데이터

**📂 원본파일**: `재난안전취약자정보_0000_서울시소방서별.csv` (26줄, 3.2KB)

#### 🔍 원본 데이터 특징
- **소방서별 통계**: 25개 소방서 관할 구역 정보
- **이미 정리된 구조**: 별도 복잡한 전처리 불필요

#### ⚙️ 전처리 과정

| 단계 | 처리 내용 | 결과 |
|------|-----------|------|
| **1️⃣ 컬럼 병합** | 해당없음 (원본 그대로) | - |
| **2️⃣ 필터링** | 해당없음 | - |
| **3️⃣ 피벗** | 해당없음 | - |
| **4️⃣ 특성선택** | • 8개 핵심 지표 선택<br>• 취약계층 관련 주요 지표만 추출 | 25개 소방서, 8개 컬럼 |

#### 📊 최종 결과
- **데이터 크기**: 25개 소방서 관할구역
- **핵심 지표**: 독거노인, 고령인구, 유아인구, 장애인, 1인가구 등
- **활용 목적**: 재난안전 취약계층 분포 분석

---

### 7️⃣ 맞벌이 가구 현황 데이터

**📂 원본파일**: `맞벌이+가구+현황_20250716125811.csv` (16줄, 389B)

#### 🔍 원본 데이터 특징
- **소규모 데이터**: 16줄의 간단한 구조
- **구별 맞벌이 가구 통계**

#### ⚙️ 전처리 과정
- **최소한의 전처리**: 기본적인 컬럼명 정리만 수행
- **활용 목적**: 보조 지표로 활용

---

## 🎯 전처리 결과 활용

### 📍 최종 데이터 통합
전처리된 모든 데이터는 다음 **히트맵 시각화**에 활용됩니다:

| 히트맵 유형 | 활용 데이터 | 파일명 |
|-------------|-------------|--------|
| **구조출동 히트맵** | 서울시_구조출동 (좌표 데이터) | `구조출동_좌표_히트맵.html` |
| **노후주택 히트맵** | 노후기간별_주택현황 | `노후주택_히트맵.html` |
| **취약연령 히트맵** | 서울시_등록인구 (0~14세, 65세 이상) | `취약연령_히트맵.html` |
| **재난안전취약자 히트맵** | 재난안전취약자정보 | `재난안전취약자_히트맵.html` |
| **화재인명피해 히트맵** | 화재발생_현황 | `화재인명피해_히트맵.html` |
| **종합 재난위험도 히트맵** | 모든 데이터 통합 | `종합_재난위험도_히트맵.html` |

### 🔍 주요 전처리 특징 요약

#### 🔄 **피벗 변환 수행 데이터**
- **서울시_등록인구**: 연령대별 행 → 컬럼 구조로 대규모 변환

#### 🎯 **대량 필터링 수행 데이터**  
- **서울시_구조출동**: 128만건 → 화재 관련 5.6만건으로 대폭 축소

#### 📊 **복잡한 헤더 정리 데이터**
- **서울시_행정구역_면적**: 3줄 헤더 → 통합 컬럼명
- **노후기간별_주택현황**: 계층형 헤더 → 체계적 명명
- **화재발생_현황**: 다차원 헤더 → 25개 세부 지표

---

## 📈 전처리 성과

### ✅ **데이터 품질 향상**
- **표준화된 구조**: 모든 데이터셋이 동일한 4단계 파이프라인 적용
- **일관된 명명**: 한글 기반 직관적 컬럼명 사용
- **최적화**: 분석 목적에 맞는 핵심 데이터만 선별

### 📊 **처리 규모**
- **원본 데이터**: 8개 파일, 약 47MB
- **최종 처리**: 구/동별 통합 분석이 가능한 정제된 데이터
- **시각화 연계**: 6개 유형의 히트맵으로 직접 활용

### 🎯 **분석 가능 영역**
1. **지역별 화재 위험도 종합 평가**
2. **취약계층 분포 기반 우선순위 지역 선정**
3. **실제 화재 발생 패턴과 위험 요소 상관관계 분석**
4. **정책 수립을 위한 데이터 기반 의사결정 지원**

---

*📝 본 보고서는 제5회 소방안전 빅데이터 활용 및 아이디어 경진대회를 위한 데이터 전처리 과정을 분석한 결과입니다.* 